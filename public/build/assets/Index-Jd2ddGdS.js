import{j as e,r as f,m as p,$ as j,S}from"./app-BEgCdFKt.js";import{D as T}from"./DashboardLayout-Cvod9ZPy.js";import{B as h}from"./button-Cxo5NDgh.js";import{C as _,c as k}from"./card-Ge9SF-CV.js";import{C as B,a as E,b as H,c as M,d as O,E as R}from"./EmptyState-Dcy-4yD3.js";import{T as $,a as F,b as g,c as n,d as z,e as m}from"./table-CJasb71A.js";import{D as L,C as q,P as G}from"./dnd.esm-CekmI3dt.js";import{A as J,a as K,b as Q,c as U,d as V,e as W,f as X,g as Y,h as Z}from"./alert-dialog-Cpd4cMA1.js";import{c as ee}from"./utils-s9Ncw-UQ.js";import{S as b}from"./star-B5x8Bp1E.js";import{T as se}from"./trash-2-Uk7KD6VJ.js";import{B as re}from"./breadcrumbs-DbGM6j6Z.js";import{S as c}from"./sweetalert2.esm.all-1yHLk2J-.js";import{A as te}from"./arrow-left-D3xMdVNv.js";import{C as ae}from"./circle-plus-nESWctQX.js";import"./tooltip-CQTOk5VK.js";import"./index-CvtYkEOn.js";import"./index-GPoiyPcv.js";import"./index-CX6RVb_s.js";import"./index-DHffHFAe.js";import"./shopping-cart-CRG7BGUT.js";import"./arrow-right-CCF4j80K.js";import"./tiny-invariant-BaFNuDhB.js";import"./index-EMsyaN-P.js";import"./Combination-DaamcoX6.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],oe=ee("Move",ie);function le({images:s,productName:a}){return e.jsxs("div",{className:"bg-white rounded-lg border shadow p-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Image Gallery Preview"}),e.jsxs(B,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(E,{children:s.map(i=>e.jsx(H,{className:"basis-full md:basis-1/2 lg:basis-1/3",children:e.jsx("div",{className:"p-1",children:e.jsx(_,{children:e.jsxs(k,{className:"flex aspect-square items-center justify-center p-2 relative",children:[e.jsx("img",{src:`/storage/${i.image_path}`,alt:i.alt_text||a,className:"w-full h-full object-cover rounded"}),i.is_primary&&e.jsx("div",{className:"absolute top-3 right-3 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded-full",children:"Primary"})]})})})},i.id))}),e.jsx(M,{className:"left-1"}),e.jsx(O,{className:"right-1"})]})]})}function de({images:s,onDelete:a,onSetPrimary:i,onDragEnd:o}){return e.jsx(L,{onDragEnd:o,children:e.jsx(q,{droppableId:"images",children:l=>e.jsxs($,{children:[e.jsx(F,{children:e.jsxs(g,{children:[e.jsx(n,{className:"w-[80px]",children:"Order"}),e.jsx(n,{children:"Image"}),e.jsx(n,{children:"Alt Text"}),e.jsx(n,{className:"text-center",children:"Primary"}),e.jsx(n,{className:"text-right",children:"Actions"})]})}),e.jsxs(z,{...l.droppableProps,ref:l.innerRef,children:[s.map((r,u)=>e.jsx(G,{draggableId:String(r.id),index:u,children:x=>e.jsxs(g,{ref:x.innerRef,...x.draggableProps,children:[e.jsx(m,{className:"w-[80px]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{...x.dragHandleProps,className:"cursor-move p-2 hover:bg-gray-100 rounded mr-2",children:e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})}),r.display_order]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-16 w-16 overflow-hidden rounded border bg-gray-50",children:e.jsx("img",{src:`/storage/${r.image_path}`,alt:r.alt_text||"Product image",className:"h-full w-full object-cover"})}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:r.image_path})]})}),e.jsx(m,{children:r.alt_text||e.jsx("span",{className:"text-muted-foreground",children:"No alt text"})}),e.jsx(m,{className:"text-center",children:r.is_primary?e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-yellow-100",children:e.jsx(b,{className:"h-3 w-3 text-yellow-500"})}):e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>i(r.id),className:"h-6 w-6 p-0 cursor-pointer",children:e.jsx(b,{className:"h-3 w-3"})})}),e.jsx(m,{className:"text-right",children:e.jsxs(J,{children:[e.jsx(K,{asChild:!0,children:e.jsx(h,{variant:"outline",size:"icon",className:" text-red-600 hover:bg-red-50 cursor-pointer",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(V,{children:"Are you sure?"}),e.jsx(W,{children:"This action cannot be undone. This will permanently delete this image."})]}),e.jsxs(X,{children:[e.jsx(Y,{className:"cursor-pointer",children:"Cancel"}),e.jsx(Z,{onClick:()=>a(r.id),className:"bg-red-500 hover:bg-red-600 cursor-pointer",children:"Delete"})]})]})]})})]})},r.id)),l.placeholder]})]})})})}function Ee({product:s,images:a,success:i}){const[o,l]=f.useState(a||[]),{delete:r}=p(),{post:u}=p(),{post:x}=p();f.useEffect(()=>{l(a)},[a]);const N=t=>{r(route("product-images.destroy",t),{onSuccess:()=>{c.fire({title:"Success!",text:"Images deleted successfully",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to delete image",icon:"error",timer:4e3,showConfirmButton:!1})}})},y=t=>{u(route("product-images.set-primary",t),{onSuccess:()=>{c.fire({title:"Success!",text:"Primary image updated",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to update primary image",icon:"error",timer:4e3,showConfirmButton:!1})}})},w=t=>{if(!t.destination)return;const d=Array.from(o),[D]=d.splice(t.source.index,1);d.splice(t.destination.index,0,D);const I=d.map((P,A)=>({...P,display_order:A+1}));l(I)},v=()=>{const t=o.map(d=>({id:d.id,display_order:d.display_order}));S.post(route("product-images.update-order",s.id),{images:t},{onSuccess:()=>{c.fire({title:"Success!",text:"Order saved successfully",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to save order",icon:"error",timer:4e3,showConfirmButton:!1})}})},C=[{title:"Dashboard",href:route("dashboard")},{title:"Product",href:route("products.index")},{title:"Show Product",href:route("products.show",s.id)},{title:"Product Image",href:route("product-images.index",s.id)}];return e.jsx(T,{title:`${s.name} - Images`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold",children:"Product Images"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(h,{variant:"outline",asChild:!0,children:e.jsxs(j,{href:route("products.show",s.id),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Back to Product"]})}),e.jsx(h,{variant:"outline",asChild:!0,children:e.jsxs(j,{href:route("product-images.create",s.id),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Add Images"]})})]})]}),e.jsx(re,{breadcrumbs:C})]}),o.length>0?e.jsxs("div",{className:"bg-white rounded-md shadow-lg border border-gray-100",children:[e.jsx(le,{images:o,productName:s.name}),e.jsxs("div",{className:"bg-white rounded-lg shadow border mt-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Manage Images"}),e.jsx(h,{className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:v,variant:"outline",children:"Save Order"})]}),e.jsx(de,{images:o,onDelete:N,onSetPrimary:y,onDragEnd:w})]})]}):e.jsx(R,{productId:s.id,title:"No images yet",description:"Add images to showcase this product.",actionText:"Add Images",actionHref:route("product-images.create",s.id)})]})})}export{Ee as default};
