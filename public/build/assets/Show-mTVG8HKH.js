import{r as x,j as e,L as _,$ as C,S as u}from"./app-8mpgRF_H.js";import{D as w,U as R}from"./DashboardLayout-82tPO0nj.js";import{C as a,a as r,b as l,c}from"./card-DHAxNADJ.js";import{B as S}from"./badge-BCW-cltX.js";import{B as h}from"./button-D7KZE6ws.js";import{T as v}from"./textarea-CEyZIjXN.js";import{A}from"./arrow-left-Dq_VdZ6f.js";import{P as j}from"./package-CuGv9LJN.js";import{C as L}from"./credit-card-DDortawr.js";import{C as B}from"./calendar-aFXUuV2M.js";import{C as p}from"./circle-check-big-Cyv3UDSl.js";import{C as D}from"./circle-x-CHLO6Tbv.js";import"./index-xngnoH4f.js";import"./utils-DT8Sk-eS.js";import"./index-CqoyiOMP.js";import"./sweetalert2.esm.all-DGhwgajj.js";import"./shopping-cart-7o6L9-KU.js";import"./log-out-BAw1qoMr.js";const k=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};function W({refund:s,vendor:f,can:i}){const[d,m]=x.useState(""),[o,g]=x.useState(""),[N,n]=x.useState(!1),b=()=>{n(!0),u.post(route("vendor.refunds.approve",s.id),{admin_notes:d},{onFinish:()=>n(!1),onSuccess:()=>{m("")}})},y=()=>{if(!o.trim()){alert("Please provide a rejection reason");return}n(!0),u.post(route("vendor.refunds.reject",s.id),{rejection_reason:o,admin_notes:d},{onFinish:()=>n(!1),onSuccess:()=>{g(""),m("")}})};return e.jsxs(w,{children:[e.jsx(_,{title:`Refund ${s.reference} - ${f.business_name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(C,{href:route("vendor.refunds.index"),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Back to Refunds"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Refund Details"}),e.jsxs("p",{className:"text-gray-600",children:["Reference: ",s.reference]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Refund Information"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:["₹",s.amount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(S,{className:k(s.refund_status),children:s.refund_status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Method"}),e.jsx("p",{className:"font-medium",children:s.method==="credit_note"?"Store Credit":s.method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Source"}),e.jsx("p",{className:"font-medium",children:s.sale?`Sale: ${s.sale.invoice_number}`:s.order?`Order: ${s.order.order_number}`:"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Reason"}),e.jsx("p",{className:"mt-1",children:s.reason})]}),s.admin_notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Admin Notes"}),e.jsx("p",{className:"mt-1 text-sm bg-gray-50 p-3 rounded",children:s.admin_notes})]}),s.rejection_reason&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Rejection Reason"}),e.jsx("p",{className:"mt-1 text-sm bg-red-50 p-3 rounded text-red-800",children:s.rejection_reason})]})]})]}),s.refund_items.length>0&&e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(l,{children:"Refunded Items"})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:s.refund_items.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.product.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["SKU: ",t.product.sku]}),t.reason&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Reason: ",t.reason]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["Qty: ",t.quantity]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["₹",t.unit_price," each"]}),e.jsxs("p",{className:"font-bold",children:["₹",t.total_amount.toLocaleString()]})]})]},t.id))})})]}),s.credit_note&&e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Credit Note"]})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Credit Note Number"}),e.jsx("p",{className:"font-medium",children:s.credit_note.credit_note_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Remaining Balance"}),e.jsxs("p",{className:"font-bold text-green-600",children:["₹",s.credit_note.remaining_amount.toLocaleString()]})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),"Customer"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:s.customer.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{children:s.customer.email})]}),s.customer.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Phone"}),e.jsx("p",{children:s.customer.phone})]})]})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Timeline"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Refund Requested"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.created_at).toLocaleString()})]})]}),s.approved_at&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Approved"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.approved_at).toLocaleString()})]})]}),s.processed_at&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Processing"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.processed_at).toLocaleString()})]})]}),s.completed_at&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Completed"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.completed_at).toLocaleString()})]})]})]})]}),(i.approve||i.reject)&&s.refund_status==="pending"&&e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(l,{children:"Actions"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Notes (Optional)"}),e.jsx(v,{value:d,onChange:t=>m(t.target.value),placeholder:"Add notes for this action...",className:"mt-1"})]}),i.reject&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Rejection Reason"}),e.jsx(v,{value:o,onChange:t=>g(t.target.value),placeholder:"Required if rejecting...",className:"mt-1"})]}),e.jsxs("div",{className:"flex gap-2",children:[i.approve&&e.jsxs(h,{onClick:b,disabled:N,className:"flex-1",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Approve"]}),i.reject&&e.jsxs(h,{variant:"destructive",onClick:y,disabled:N,className:"flex-1",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]})]})]})]})]})]})}export{W as default};
