import{j as e,L as f,S as y}from"./app-D7-1ebmt.js";import{u as C,D as N,B as _}from"./DashboardLayout-fOS_2bg6.js";import{B as x}from"./button-DWVGmOTx.js";import{I as u}from"./input-BtS1u5IQ.js";import{S}from"./switch-BXNgZO4n.js";import{u as w,F,a as r,b as i,c as l,d as o,e as c,f as m}from"./form-3kBJRc9J.js";import{B as D}from"./breadcrumbs-NQydwA2d.js";import{S as E}from"./sweetalert2.all-BtRqQ04W.js";import{S as U,a as T,b as k,c as B,d as h}from"./select-BRg6RUNw.js";import{s as M}from"./zod-wIezJdas.js";import{o as I,b as L,s as j,c as p,e as V}from"./index-B9ALDWfZ.js";import"./index-CKAdTIHf.js";import"./utils-B4oaFPBB.js";import"./index-BUhvCdw_.js";import"./tooltip-Cm9TE5Xq.js";import"./index-CD7Mla1U.js";import"./label-CoDA9lWC.js";import"./index-493IWVPe.js";import"./Combination-DMdNX4qb.js";import"./check-DeEZbx2Z.js";const P=I({code:j().min(3,"Code must be at least 3 characters").max(30,"Code cannot exceed 30 characters").toUpperCase(),type:V(["fixed","percentage"]),value:p.number().min(0,"Value must be at least 0").refine(n=>!0,{message:"Value is required"}),min_spend:p.number().nullable().optional(),max_discount:p.number().nullable().optional(),usage_limit:p.number().int().nullable().optional(),expires_at:j().nullable().optional(),status:L().default(!0)});function re({coupon:n}){C();const g=s=>s?new Date(s).toISOString().slice(0,16):null,a=w({resolver:M(P),values:{code:n.code,type:n.type,value:n.value,min_spend:n.min_spend,max_discount:n.max_discount,usage_limit:n.usage_limit,expires_at:g(n.expires_at),status:n.status}});function v(s){if(s.type==="percentage"&&s.value>100){a.setError("value",{message:"Percentage discount cannot exceed 100%"});return}const t=new FormData;t.append("code",s.code),t.append("type",s.type),t.append("value",s.value.toString()),s.min_spend!=null&&t.append("min_spend",s.min_spend.toString()),s.max_discount!=null&&t.append("max_discount",s.max_discount.toString()),s.usage_limit!=null&&t.append("usage_limit",s.usage_limit.toString()),s.expires_at&&t.append("expires_at",s.expires_at),t.append("status",s.status?"1":"0"),t.append("_method","PUT"),y.post(route("coupons.update",n.id),t,{onSuccess:()=>{E.fire({title:"Coupon Updated",text:`${s.code} has been updated successfully.`,icon:"success",timer:4e3,showConfirmButton:!1})}})}const b=[{title:"Dashboard",href:route("dashboard")},{title:"Coupons",href:route("coupons.index")},{title:"Edit Coupon",href:route("coupons.update",n.id)}];return e.jsxs(N,{title:"Edit Coupon",children:[e.jsx(f,{title:"Edit Coupon"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Coupon"}),e.jsx("p",{className:"text-muted-foreground",children:"Update an existing discount coupon"})]}),e.jsx(D,{breadcrumbs:b})]}),e.jsx("div",{className:"bg-white rounded-md shadow-lg border border-gray-100 p-6",children:e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(_,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Coupon Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure your discount coupon"})]})]}),e.jsx(F,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(v),className:"space-y-6",children:[e.jsx(r,{control:a.control,name:"code",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Coupon Code"}),e.jsx(o,{children:e.jsx(u,{...s,placeholder:"SUMMER20",onChange:t=>s.onChange(t.target.value.toUpperCase())})}),e.jsx(c,{children:"Enter a unique code customers will use to apply the discount."}),e.jsx(m,{})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(r,{control:a.control,name:"type",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Type"}),e.jsxs(U,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(T,{children:e.jsx(k,{placeholder:"Select type"})})}),e.jsxs(B,{children:[e.jsx(h,{value:"percentage",children:"Percentage"}),e.jsx(h,{value:"fixed",children:"Fixed Amount"})]})]}),e.jsx(c,{children:"How the discount will be applied"}),e.jsx(m,{})]})}),e.jsx(r,{control:a.control,name:"value",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Value"}),e.jsx(o,{children:e.jsxs("div",{className:"relative",children:[e.jsx(u,{type:"number",min:"0",step:a.watch("type")==="percentage"?"1":"0.01",...s,placeholder:a.watch("type")==="percentage"?"10":"5.00"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:a.watch("type")==="percentage"?"%":"$"})]})}),e.jsx(c,{children:a.watch("type")==="percentage"?"Percentage discount to apply (1-100)":"Fixed amount to deduct from the order"}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(r,{control:a.control,name:"min_spend",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Minimum Spend"}),e.jsx(o,{children:e.jsxs("div",{className:"relative",children:[e.jsx(u,{type:"number",min:"0",step:"0.01",...s,value:s.value===null?"":s.value,onChange:t=>{const d=t.target.value===""?null:parseFloat(t.target.value);s.onChange(d)},placeholder:"0.00"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:"$"})]})}),e.jsx(c,{children:"Minimum order amount required (optional)"}),e.jsx(m,{})]})}),e.jsx(r,{control:a.control,name:"max_discount",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Maximum Discount"}),e.jsx(o,{children:e.jsxs("div",{className:"relative",children:[e.jsx(u,{type:"number",min:"0",step:"0.01",...s,value:s.value===null?"":s.value,onChange:t=>{const d=t.target.value===""?null:parseFloat(t.target.value);s.onChange(d)},placeholder:"0.00"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:"$"})]})}),e.jsx(c,{children:"Maximum discount amount (optional)"}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(r,{control:a.control,name:"usage_limit",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Usage Limit"}),e.jsx(o,{children:e.jsx(u,{type:"number",min:"1",step:"1",...s,value:s.value===null?"":s.value,onChange:t=>{const d=t.target.value===""?null:parseInt(t.target.value);s.onChange(d)},placeholder:"Unlimited"})}),e.jsx(c,{children:"How many times this coupon can be used (optional)"}),e.jsx(m,{})]})}),e.jsx(r,{control:a.control,name:"expires_at",render:({field:s})=>e.jsxs(i,{children:[e.jsx(l,{children:"Expiry Date"}),e.jsx(o,{children:e.jsx(u,{type:"datetime-local",...s,value:s.value||"",onChange:t=>{const d=t.target.value===""?null:t.target.value;s.onChange(d)}})}),e.jsx(c,{children:"When this coupon expires (optional)"}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Usage Statistics"}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsxs("div",{className:"font-medium",children:["Used ",n.used_count," times"]}),n.usage_limit&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[n.used_count," out of ",n.usage_limit," available uses"]})]})]}),e.jsx(r,{control:a.control,name:"status",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Active"}),e.jsx(c,{children:"Coupon will be available for use"})]}),e.jsx(o,{children:e.jsx(S,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(x,{type:"button",variant:"outline",className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(x,{type:"submit",variant:"outline",className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",disabled:a.formState.isSubmitting,children:a.formState.isSubmitting?"Saving...":"Save Changes"})]})]})})]})})})]})}export{re as default};
