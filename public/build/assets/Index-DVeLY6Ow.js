import{j as e,r as j,m as p,$ as f,S as A}from"./index.esm-Bc_4NMHb.js";import{C as S,c as T,D as _}from"./DashboardLayout-CHxeyx5p.js";import{B as x}from"./button-DZWuNibM.js";import{C as k,a as B,b as E,c as H,d as M,E as R}from"./EmptyState-CRSE-PPA.js";import{T as $,a as F,b as g,c as m,d as O,e as h}from"./table-CpPp2o9C.js";import{D as z,C as L,P as q}from"./dnd.esm-82YFROLo.js";import{A as G,a as J,b as K,c as Q,d as U,e as V,f as W,g as X,h as Y}from"./alert-dialog-nLufNxnG.js";import{c as Z}from"./createLucideIcon-C4cwkqtv.js";import{S as b}from"./star-D0TkpJje.js";import{T as ee}from"./trash-2-PUX_MnWe.js";import{B as se}from"./breadcrumbs-Y_9G2NoR.js";import{S as c}from"./sweetalert2.esm.all-DGhwgajj.js";import{A as re}from"./arrow-left-CF2BqPGQ.js";import{C as te}from"./circle-plus-DOci5qfB.js";import"./index-bytDxa8N.js";import"./app-DT6hknfK.js";import"./utils-RaGAWv6d.js";import"./index-U4gapAO2.js";import"./tiny-invariant-BaFNuDhB.js";import"./index-MSZzFWES.js";import"./Combination-D0skWEO_.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],ie=Z("Move",ae);function oe({images:s,productName:a}){return e.jsxs("div",{className:"bg-white rounded-lg border shadow p-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Image Gallery Preview"}),e.jsxs(k,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(B,{children:s.map(i=>e.jsx(E,{className:"basis-full md:basis-1/2 lg:basis-1/3",children:e.jsx("div",{className:"p-1",children:e.jsx(S,{children:e.jsxs(T,{className:"flex aspect-square items-center justify-center p-2 relative",children:[e.jsx("img",{src:`/storage/${i.image_path}`,alt:i.alt_text||a,className:"w-full h-full object-cover rounded"}),i.is_primary&&e.jsx("div",{className:"absolute top-3 right-3 bg-yellow-400 text-black text-xs font-bold px-2 py-1 rounded-full",children:"Primary"})]})})})},i.id))}),e.jsx(H,{className:"left-1"}),e.jsx(M,{className:"right-1"})]})]})}function le({images:s,onDelete:a,onSetPrimary:i,onDragEnd:o}){return e.jsx(z,{onDragEnd:o,children:e.jsx(L,{droppableId:"images",children:l=>e.jsxs($,{children:[e.jsx(F,{children:e.jsxs(g,{children:[e.jsx(m,{className:"w-[80px]",children:"Order"}),e.jsx(m,{children:"Image"}),e.jsx(m,{children:"Alt Text"}),e.jsx(m,{className:"text-center",children:"Primary"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsxs(O,{...l.droppableProps,ref:l.innerRef,children:[s.map((r,u)=>e.jsx(q,{draggableId:String(r.id),index:u,children:n=>e.jsxs(g,{ref:n.innerRef,...n.draggableProps,children:[e.jsx(h,{className:"w-[80px]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{...n.dragHandleProps,className:"cursor-move p-2 hover:bg-gray-100 rounded mr-2",children:e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"})}),r.display_order]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-16 w-16 overflow-hidden rounded border bg-gray-50",children:e.jsx("img",{src:`/storage/${r.image_path}`,alt:r.alt_text||"Product image",className:"h-full w-full object-cover"})}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:r.image_path})]})}),e.jsx(h,{children:r.alt_text||e.jsx("span",{className:"text-muted-foreground",children:"No alt text"})}),e.jsx(h,{className:"text-center",children:r.is_primary?e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-yellow-100",children:e.jsx(b,{className:"h-3 w-3 text-yellow-500"})}):e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>i(r.id),className:"h-6 w-6 p-0 cursor-pointer",children:e.jsx(b,{className:"h-3 w-3"})})}),e.jsx(h,{className:"text-right",children:e.jsxs(G,{children:[e.jsx(J,{asChild:!0,children:e.jsx(x,{variant:"outline",size:"icon",className:" text-red-600 hover:bg-red-50 cursor-pointer",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsx(U,{children:"Are you sure?"}),e.jsx(V,{children:"This action cannot be undone. This will permanently delete this image."})]}),e.jsxs(W,{children:[e.jsx(X,{className:"cursor-pointer",children:"Cancel"}),e.jsx(Y,{onClick:()=>a(r.id),className:"bg-red-500 hover:bg-red-600 cursor-pointer",children:"Delete"})]})]})]})})]})},r.id)),l.placeholder]})]})})})}function Se({product:s,images:a,success:i}){const[o,l]=j.useState(a||[]),{delete:r}=p(),{post:u}=p();p(),j.useEffect(()=>{l(a)},[a]);const n=t=>{r(route("product-images.destroy",t),{onSuccess:()=>{c.fire({title:"Success!",text:"Images deleted successfully",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to delete image",icon:"error",timer:4e3,showConfirmButton:!1})}})},N=t=>{u(route("product-images.set-primary",t),{onSuccess:()=>{c.fire({title:"Success!",text:"Primary image updated",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to update primary image",icon:"error",timer:4e3,showConfirmButton:!1})}})},y=t=>{if(!t.destination)return;const d=Array.from(o),[C]=d.splice(t.source.index,1);d.splice(t.destination.index,0,C);const D=d.map((I,P)=>({...I,display_order:P+1}));l(D)},w=()=>{const t=o.map(d=>({id:d.id,display_order:d.display_order}));A.post(route("product-images.update-order",s.id),{images:t},{onSuccess:()=>{c.fire({title:"Success!",text:"Order saved successfully",icon:"success",timer:4e3,showConfirmButton:!1})},onError:()=>{c.fire({title:"Error!",text:"Failed to save order",icon:"error",timer:4e3,showConfirmButton:!1})}})},v=[{title:"Dashboard",href:route("dashboard")},{title:"Product",href:route("products.index")},{title:"Show Product",href:route("products.show",s.id)},{title:"Product Image",href:route("product-images.index",s.id)}];return e.jsx(_,{title:`${s.name} - Images`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold",children:"Product Images"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(x,{variant:"outline",asChild:!0,children:e.jsxs(f,{href:route("products.show",s.id),children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Back to Product"]})}),e.jsx(x,{variant:"outline",asChild:!0,children:e.jsxs(f,{href:route("product-images.create",s.id),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Images"]})})]})]}),e.jsx(se,{breadcrumbs:v})]}),o.length>0?e.jsxs("div",{className:"bg-white rounded-md shadow-lg border border-gray-100",children:[e.jsx(oe,{images:o,productName:s.name}),e.jsxs("div",{className:"bg-white rounded-lg shadow border mt-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Manage Images"}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:w,variant:"outline",children:"Save Order"})]}),e.jsx(le,{images:o,onDelete:n,onSetPrimary:N,onDragEnd:y})]})]}):e.jsx(R,{productId:s.id,title:"No images yet",description:"Add images to showcase this product.",actionText:"Add Images",actionHref:route("product-images.create",s.id)})]})})}export{Se as default};
