import{r as a,j as M}from"./app-im_ysnYb.js";import{u as _}from"./utils-BEbS4aeS.js";import{P as K}from"./index-DSWK_eac.js";import{d as N}from"./index-BjyQ3WaK.js";var k=a.createContext(void 0);function X(e){const t=a.useContext(k);return e||t||"ltr"}var F=0;function Y(){a.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??S()),document.body.insertAdjacentElement("beforeend",e[1]??S()),F++,()=>{F===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),F--}},[])}function S(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var y="focusScope.autoFocusOnMount",h="focusScope.autoFocusOnUnmount",C={bubbles:!1,cancelable:!0},w="FocusScope",D=a.forwardRef((e,t)=>{const{loop:n=!1,trapped:u=!1,onMountAutoFocus:p,onUnmountAutoFocus:I,...L}=e,[o,P]=a.useState(null),E=N(p),v=N(I),b=a.useRef(null),U=_(t,s=>P(s)),d=a.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;a.useEffect(()=>{if(u){let s=function(i){if(d.paused||!o)return;const c=i.target;o.contains(c)?b.current=c:f(b.current,{select:!0})},l=function(i){if(d.paused||!o)return;const c=i.relatedTarget;c!==null&&(o.contains(c)||f(b.current,{select:!0}))},r=function(i){if(document.activeElement===document.body)for(const T of i)T.removedNodes.length>0&&f(o)};document.addEventListener("focusin",s),document.addEventListener("focusout",l);const m=new MutationObserver(r);return o&&m.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",s),document.removeEventListener("focusout",l),m.disconnect()}}},[u,o,d.paused]),a.useEffect(()=>{if(o){O.add(d);const s=document.activeElement;if(!o.contains(s)){const r=new CustomEvent(y,C);o.addEventListener(y,E),o.dispatchEvent(r),r.defaultPrevented||(j(W(A(o)),{select:!0}),document.activeElement===s&&f(o))}return()=>{o.removeEventListener(y,E),setTimeout(()=>{const r=new CustomEvent(h,C);o.addEventListener(h,v),o.dispatchEvent(r),r.defaultPrevented||f(s??document.body,{select:!0}),o.removeEventListener(h,v),O.remove(d)},0)}}},[o,E,v,d]);const R=a.useCallback(s=>{if(!n&&!u||d.paused)return;const l=s.key==="Tab"&&!s.altKey&&!s.ctrlKey&&!s.metaKey,r=document.activeElement;if(l&&r){const m=s.currentTarget,[i,c]=H(m);i&&c?!s.shiftKey&&r===c?(s.preventDefault(),n&&f(i,{select:!0})):s.shiftKey&&r===i&&(s.preventDefault(),n&&f(c,{select:!0})):r===m&&s.preventDefault()}},[n,u,d.paused]);return M.jsx(K.div,{tabIndex:-1,...L,ref:U,onKeyDown:R})});D.displayName=w;function j(e,{select:t=!1}={}){const n=document.activeElement;for(const u of e)if(f(u,{select:t}),document.activeElement!==n)return}function H(e){const t=A(e),n=g(t,e),u=g(t.reverse(),e);return[n,u]}function A(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:u=>{const p=u.tagName==="INPUT"&&u.type==="hidden";return u.disabled||u.hidden||p?NodeFilter.FILTER_SKIP:u.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function g(e,t){for(const n of e)if(!G(n,{upTo:t}))return n}function G(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function q(e){return e instanceof HTMLInputElement&&"select"in e}function f(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&q(e)&&t&&e.select()}}var O=V();function V(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=x(e,t),e.unshift(t)},remove(t){var n;e=x(e,t),(n=e[0])==null||n.resume()}}}function x(e,t){const n=[...e],u=n.indexOf(t);return u!==-1&&n.splice(u,1),n}function W(e){return e.filter(t=>t.tagName!=="A")}export{D as F,Y as a,X as u};
