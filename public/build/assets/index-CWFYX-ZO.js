import{r as c,t as M,j as _}from"./app-uAdQgTs8.js";import{b as K,u as T}from"./index-W-PvzrYH.js";import{u as k}from"./utils-BGMc812E.js";import{P as w}from"./index-DLvvQ_1D.js";var D=M.useId||(()=>{}),j=0;function ee(e){const[t,n]=c.useState(D());return K(()=>{n(o=>o??String(j++))},[e]),e||(t?`radix-${t}`:"")}var H=c.createContext(void 0);function te(e){const t=c.useContext(H);return e||t||"ltr"}var y=0;function ne(){c.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??g()),document.body.insertAdjacentElement("beforeend",e[1]??g()),y++,()=>{y===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),y--}},[])}function g(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var F="focusScope.autoFocusOnMount",h="focusScope.autoFocusOnUnmount",N={bubbles:!1,cancelable:!0},G="FocusScope",q=c.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:p,onUnmountAutoFocus:A,...L}=e,[s,P]=c.useState(null),E=T(p),v=T(A),b=c.useRef(null),R=k(t,u=>P(u)),d=c.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;c.useEffect(()=>{if(o){let u=function(i){if(d.paused||!s)return;const a=i.target;s.contains(a)?b.current=a:f(b.current,{select:!0})},l=function(i){if(d.paused||!s)return;const a=i.relatedTarget;a!==null&&(s.contains(a)||f(b.current,{select:!0}))},r=function(i){if(document.activeElement===document.body)for(const S of i)S.removedNodes.length>0&&f(s)};document.addEventListener("focusin",u),document.addEventListener("focusout",l);const m=new MutationObserver(r);return s&&m.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",u),document.removeEventListener("focusout",l),m.disconnect()}}},[o,s,d.paused]),c.useEffect(()=>{if(s){x.add(d);const u=document.activeElement;if(!s.contains(u)){const r=new CustomEvent(F,N);s.addEventListener(F,E),s.dispatchEvent(r),r.defaultPrevented||(V(J(O(s)),{select:!0}),document.activeElement===u&&f(s))}return()=>{s.removeEventListener(F,E),setTimeout(()=>{const r=new CustomEvent(h,N);s.addEventListener(h,v),s.dispatchEvent(r),r.defaultPrevented||f(u??document.body,{select:!0}),s.removeEventListener(h,v),x.remove(d)},0)}}},[s,E,v,d]);const U=c.useCallback(u=>{if(!n&&!o||d.paused)return;const l=u.key==="Tab"&&!u.altKey&&!u.ctrlKey&&!u.metaKey,r=document.activeElement;if(l&&r){const m=u.currentTarget,[i,a]=W(m);i&&a?!u.shiftKey&&r===a?(u.preventDefault(),n&&f(i,{select:!0})):u.shiftKey&&r===i&&(u.preventDefault(),n&&f(a,{select:!0})):r===m&&u.preventDefault()}},[n,o,d.paused]);return _.jsx(w.div,{tabIndex:-1,...L,ref:R,onKeyDown:U})});q.displayName=G;function V(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(f(o,{select:t}),document.activeElement!==n)return}function W(e){const t=O(e),n=C(t,e),o=C(t.reverse(),e);return[n,o]}function O(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const p=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||p?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function C(e,t){for(const n of e)if(!$(n,{upTo:t}))return n}function $(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function z(e){return e instanceof HTMLInputElement&&"select"in e}function f(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&z(e)&&t&&e.select()}}var x=B();function B(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=I(e,t),e.unshift(t)},remove(t){var n;e=I(e,t),(n=e[0])==null||n.resume()}}}function I(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function J(e){return e.filter(t=>t.tagName!=="A")}export{q as F,ee as a,ne as b,te as u};
